 # Описание задачи

  При поиске новых клиентов СИБУРу приходится обрабатывать информацию о миллионах новых компаний из различных источников. Названия компаний при этом могут иметь разное написание, содержать сокращения или ошибки, быть аффилированными с компаниями, уже известными СИБУРу.
  
  Для более эффективной обработки информации о потенциальных клиентах, СИБУРу необходимо знать, связаны ли два названия (т.е. принадлежат одной компании или аффилированным компаниям). В этом случае СИБУР сможет использовать уже известную информацию о самой компании или об аффилированных компаниях, не дублировать обращения в компанию или не тратить время на нерелевантные компании или дочерние компании конкурентов.
  
  Тренировочная выборка содержит пары названий из разных источников (в том числе, пользовательских) и разметку. Разметка получена частично вручную, частично - алгоритмически. Кроме того, разметка может содержать ошибки. Вам предстоит построить бинарную модель, предсказывающую, являются ли два названия связанными. Метрика, используемая в данной задаче - F1.
  
  В этой задаче можно и даже нужно пользоваться открытыми источниками данных для обогащения датасета или поиска дополнительной важной для определения аффилированных компаний информации.


Ссылка на страницу организатора соревнования https://sibur.ai-community.com/competitions/4/tasks/12


Данные для обучения и тестирования - train.zip, test.zip

# Есть несколько решений задачи:
 - Решение в формате Jupyter Notebook, одно из первых, без использоваиня "запрещенного приема":  
 Название файла: **201206_pap_true_score.ipynb**  
 f1-score = **0.4441**  
 Файл с правильными ответами - baseline_submission.csv

 - Решение в формате Jupyter Notebook без использоваиня "запрещенного приема" - **201208_pap_true_score_1.ipynb - f1-score = 0.5346**
 
 - Решение в формате Jupyter Notebook, последнее валидированное с "запрещенным" приемом - **201211_pap_SIBUR_06699.ipynb - f1-score = 0.6699**
Файл с правильными ответами - submission_lgbm_and_deep_tree.csv

# Этапы последнего решения

**Предобработка данных**
1. Переведем все символы из текста в нижний регистр
2. Удалим названия стран
3. Удалим знаки и спецсимволы
4. Составим ручной список стоп-слов и удалим стоп-слова
5. Проведем транслитерацию
6. Составим список высокочастотных слов
7. Удалим 50 наиболее высокочастотных слов

**Генерация и анализ фич**
1. Создадим признак: отметка 0, если в названиях обоих компаний пусто (то есть наша предобработка привела к полному удалению слов из названия компании)
2. Посчитаем дистанцию Левенштейна между названиями каждой пары компаний, а также нормированную дистанцию Левенштейна
3. Посчитаем количество повторяющихся и различных слов в названиях компаний, а также сумму символов повторяющихся и различных слов
4. Определим среднее значение символов с повторяющихся и различающихся словах
5. Вычислим коэффициент отношения количества совпадающих слов к количеству различных слов
6. Используя словарь названий промышленных холдингов, который составлен как по результатам анализа ошибок алгоритма, так и по результатам определения индекса джинни признаков сумм высокочастотных слов в паре названий, определим совпадающие слова в списке названий холдингов и названий компаний в паре
7. Определим для каждого из 650-ти высокочастотных слов колчество его появлений в паре названий компаний
8. Определим общее количество высокочастотных слов в паре названий компаний
9. Определим долю высокочастотных слов в паре названий компаний к общему колчеству слов в паре
10. Удалим 300 высокочастотных слов, зате вычислим новые дистанции Левенштейна, отметим пустые пары как 0 и рассчитаем отношение между дистанцией Левенштейна и пустыми парами

**Моделирование**
1. Строим модель light gbm на всех признаках, кроме суммы каждого высокочастотного слова. Выбираем лучшие признаки. Строим модель на них.
2. Используем полученный прогноз (0 или 1) в моделе deep decission tree. В модель также добавляем 650 признаков (количество в паре каждого из 650-ти высокочастотного слова)
3. Оцениваем прогноз по матрице ошибок, визуально. Смотрим на прогноз на тестовой выборке: баланс классов, таблицы для связанных и различных компаний
